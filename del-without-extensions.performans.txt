#PowerShell script’i extensions.performance.txt içinde olmayan tüm VSCode eklentilerini otomatik olarak siler.
#(Performance listesi = kalacaklar, bunun dışındakiler = kaldırılacaklar)

# PowerShell Script — “Listedekiler dışındaki tüm extension’ları sil”

#Kullanım:
#VSCode kapalı olsun → PowerShell → script’i çalıştır.
-------------------------------------------------

# Path to allowed extensions list
$allowedListPath = "extensions.performans.txt"

# Load allowed extension IDs (trim + remove blanks)
$allowed = Get-Content $allowedListPath | ForEach-Object { $_.Trim() } | Where-Object { $_ -ne "" }

Write-Host "`nAllowed extensions:" -ForegroundColor Cyan
$allowed | ForEach-Object { Write-Host "  $_" }

# Get currently installed extensions
$installed = code --list-extensions

Write-Host "`nInstalled extensions:" -ForegroundColor Yellow
$installed | ForEach-Object { Write-Host "  $_" }

# Find extensions that are NOT in allowed list
$toRemove = $installed | Where-Object { $allowed -notcontains $_ }

Write-Host "`nExtensions to REMOVE:" -ForegroundColor Red
$toRemove | ForEach-Object { Write-Host "  $_" }

# Confirmation
Write-Host "`nProceed with uninstalling these extensions? (Y/N)" -ForegroundColor Magenta
$confirm = Read-Host

if ($confirm -eq "Y") {

    foreach ($ext in $toRemove) {
        Write-Host "Removing $ext..." -ForegroundColor Red
        code --uninstall-extension $ext --force
    }

    Write-Host "`nCleanup complete." -ForegroundColor Green
} else {
    Write-Host "Aborted." -ForegroundColor Yellow
}
